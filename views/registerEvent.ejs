<!DOCTYPE html>
<html>
  <head>
    <title>Available Events</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="container mt-5">
    <h2 class="mb-4">Available Events</h2>

    <ul class="list-group">
      <% events.forEach(e => { %>
      <li class="list-group-item">
        <h5><%= e.name %></h5>
        <p><%= e.description %></p>
        <p><strong>Date:</strong> <%= e.date %></p>
        <p><strong>Location:</strong> <%= e.location %></p>
        <p>
          <strong>Capacity:</strong> <%= e.registeredCount %> / <%= e.capacity
          %>
        </p>

        <% if (e.isRegistered) { %>
        <form method="POST" action="/events/unregister/<%= e._id %>">
          <button type="submit" class="btn btn-danger">Unregister</button>
        </form>
        <% } else if (e.registeredCount < e.capacity) { %>
        <form method="POST" action="/events/register/<%= e._id %>">
          <button type="submit" class="btn btn-success">Register</button>
        </form>
        <% } else { %>
        <span class="text-muted">Full</span>
        <% } %>
      </li>
      <% }) %>
    </ul>
  </body>
</html>
